# Глава2. Клиент-серверные сети только по IP

Мы рассмотрим следующие темы:

* Настройка публичных и приватных ключей
* Простая конфигурация
* Серверная маршрутизация
* Добавление поддержки IPv6
* Использование файлов `client-config-dir` 
* Маршрутизация - подсети с обоими направлениями
* Перенаправление шлюза по умолчанию
* Перенаправление шлюза по умолчанию IPv6
* Использование блока `ifconfig-pool` 
* Использование файла состояния
* Интерфейс управления
* Proxy-агр

## Вступление

Рецепты в этой главе будут касаться наиболее часто используемой модели развертывания OpenVPN: один сервер с несколькими удаленными клиентами, способными маршрутизировать IP-трафик.

Мы также рассмотрим несколько распространенных конфигураций маршрутизации в дополнение к использованию интерфейса управления как на стороне клиента, так и на стороне сервера.

Последний рецепт этой главы покажет, как можно избежать использования сетевых мостов для большинства практических случаев использования.

Поскольку маршрутизируемая настройка в стиле TUN является наиболее часто используемой моделью развертывания - некоторые примеры конфигурационных файлов, представленные в этой главе, будут повторно использоваться в остальной части книги. В частности, это файлы конфигурации типа `basic-udp-server.conf`, `basic-udp-client.conf`, `basic-tcp-server.conf`, а также `basic-tcp-client.conf` из рецепта _Маршрутизации на стороне сервера_ будут часто использоваться повторно, а также файлы конфигурации клиента Windows `basic-udp-client.ovpn` и `basic-tcp-клиент.ovpn` из рецепта _Использование блока ifconfig-pool_.

## Настройка публичных и приватных ключей

Прежде чем мы сможем настроить VPN для режима клиент-сервер - нам нужно настроить инфраструктуру открытых ключей (PKI). PKI включает в себя центр сертификации, приватные ключи и сертификаты (публичные ключи) как для клиента, так и для сервера. Нам также нужно создать файл параметров Диффи-Хеллмана, который необходим для идеальной секретности.

Для настройки PKI мы используем скрипт `easy-rsa`. Эти скрипты изначально поставлялись вместе с самим дистрибутивом OpenVPN, но в настоящее время они также могут быть загружены и установлены отдельно.
